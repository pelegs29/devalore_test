import requests
import json


def fetch_rates(env):
    rates = []
    url = "https://api.apilayer.com/exchangerates_data/latest"
    payload = {}
    headers = {
        "apikey": "ucTmfTVETT60Jb92G3NYRlgpaAIfDr5v"
    }

    if env.lower() == 'prod':
        response = requests.request("GET", url, headers=headers, data=payload).json()
    elif env.lower() == 'dev':
        response = {'success': True,
                    'timestamp': 1668418322,
                    'base': 'EUR',
                    'date': '2022-11-14',
                    'rates': {
                        'AED': 3.79124,
                        'AFN': 91.022117,
                        'ALL': 117.040178,
                        'AMD': 407.294341,
                        'ANG': 1.854032,
                        'AOA': 509.64642,
                        'ARS': 165.873984,
                        'AUD': 1.543148, 'AWG': 1.86052, 'AZN': 1.75798, 'BAM': 1.955127, 'BBD': 2.076993,
                        'BDT': 105.129594, 'BGN': 1.953128, 'BHD': 0.389165, 'BIF': 2127.86294, 'BMD': 1.032189,
                        'BND': 1.416649, 'BOB': 7.107803, 'BRL': 5.497027, 'BSD': 1.02865, 'BTC': 6.1885708e-05,
                        'BTN': 83.124127, 'BWP': 13.324966, 'BYN': 2.597516, 'BYR': 20230.900636, 'BZD': 2.073495,
                        'CAD': 1.371418, 'CDF': 2109.79363, 'CHF': 0.975646, 'CLF': 0.033329, 'CLP': 919.638903,
                        'CNY': 7.278068, 'COP': 4939.905651, 'CRC': 626.789944, 'CUC': 1.032189, 'CUP': 27.353003,
                        'CVE': 110.214687, 'CZK': 24.272973, 'DJF': 183.127693, 'DKK': 7.43821, 'DOP': 55.954999,
                        'DZD': 143.405111, 'EGP': 25.197072, 'ERN': 15.482832, 'ETB': 54.929841, 'EUR': 1,
                        'FJD': 2.305603,
                        'FKP': 0.872091, 'GBP': 0.875513, 'GEL': 2.797289, 'GGP': 0.872091, 'GHS': 14.914481,
                        'GIP': 0.872091, 'GMD': 63.247361, 'GNF': 8862.256423, 'GTQ': 8.043039, 'GYD': 215.155951,
                        'HKD': 8.090575, 'HNL': 25.422966, 'HRK': 7.5454, 'HTG': 139.376451, 'HUF': 406.135566,
                        'IDR': 16037.788432, 'ILS': 3.531082, 'IMP': 0.872091, 'INR': 83.797272, 'IQD': 1501.311014,
                        'IRR': 43661.586011, 'ISK': 149.915108, 'JEP': 0.872091, 'JMD': 158.211002, 'JOD': 0.731848,
                        'JPY': 144.639555, 'KES': 125.81348, 'KGS': 87.014241, 'KHR': 4260.540817, 'KMF': 498.854174,
                        'KPW': 928.969927, 'KRW': 1366.447703, 'KWD': 0.31776, 'KYD': 0.857183, 'KZT': 473.555114,
                        'LAK': 17815.238541, 'LBP': 1555.570732, 'LKR': 378.02743, 'LRD': 158.747681, 'LSL': 17.949945,
                        'LTL': 3.047785, 'LVL': 0.624361, 'LYD': 5.128255, 'MAD': 11.050451, 'MDL': 19.75078,
                        'MGA': 4413.058501, 'MKD': 61.691132, 'MMK': 2160.239, 'MNT': 3519.494829, 'MOP': 8.304853,
                        'MRO': 368.491227, 'MUR': 45.269684, 'MVR': 15.905641, 'MWK': 1055.878748, 'MXN': 20.136558,
                        'MYR': 4.744248, 'MZN': 65.884282, 'NAD': 17.949921, 'NGN': 457.783942, 'NIO': 37.028478,
                        'NOK': 10.296878, 'NPR': 133.006571, 'NZD': 1.695102, 'OMR': 0.396923, 'PAB': 1.028595,
                        'PEN': 3.967193, 'PGK': 3.62479, 'PHP': 58.974621, 'PKR': 227.853775, 'PLN': 4.688769,
                        'PYG': 7339.002977, 'QAR': 3.758208, 'RON': 4.897632, 'RSD': 117.323757, 'RUB': 62.318427,
                        'RWF': 1099.992381, 'SAR': 3.88035, 'SBD': 8.495525, 'SCR': 14.080801, 'SDG': 586.800734,
                        'SEK': 10.735078, 'SGD': 1.418429, 'SHP': 1.421735, 'SLE': 18.522417, 'SLL': 18393.604517,
                        'SOS': 586.283428, 'SRD': 31.024463, 'STD': 21364.224344, 'SVC': 9.000589, 'SYP': 2593.406753,
                        'SZL': 17.750461, 'THB': 37.050935, 'TJS': 10.336581, 'TMT': 3.622983, 'TND': 3.270488,
                        'TOP': 2.448713, 'TRY': 19.204801, 'TTD': 6.984319, 'TWD': 31.964307, 'TZS': 2407.064066,
                        'UAH': 37.991574, 'UGX': 3872.6072, 'USD': 1.032189, 'UYU': 41.269162, 'UZS': 11528.032645,
                        'VEF': 956714.555485, 'VND': 25536.351109, 'VUV': 123.529753, 'WST': 2.87517, 'XAF': 655.756121,
                        'XAG': 0.047919, 'XAU': 0.000587, 'XCD': 2.789542, 'XDR': 0.800628, 'XOF': 655.733893,
                        'XPF': 121.333845, 'YER': 258.305094, 'ZAR': 17.844232, 'ZMK': 9290.928021, 'ZMW': 16.860163,
                        'ZWL': 332.364375}}
    else:
        raise Exception("Wrong Environment")

    for curr, rate in response['rates'].items():
        if rate < 10:
            rates.append(curr)
    return rates


if __name__ == '__main__':
    environment = ''

    while environment != 'Dev' and environment != "Prod":
        environment = input("Enter your environment: (Dev/Prod) ")

    fetch_rates(environment)
